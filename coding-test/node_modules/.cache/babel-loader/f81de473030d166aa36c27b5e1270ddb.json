{"ast":null,"code":"function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nimport { ARRAY_INSERT, ARRAY_MOVE, ARRAY_POP, ARRAY_PUSH, ARRAY_REMOVE, ARRAY_REMOVE_ALL, ARRAY_SHIFT, ARRAY_SPLICE, ARRAY_SWAP, ARRAY_UNSHIFT, AUTOFILL, BLUR, CHANGE, CLEAR_SUBMIT, CLEAR_ASYNC_ERROR, DESTROY, FOCUS, INITIALIZE, REGISTER_FIELD, RESET, SET_SUBMIT_FAILED, SET_SUBMIT_SUCCEEDED, START_ASYNC_VALIDATION, START_SUBMIT, STOP_ASYNC_VALIDATION, STOP_SUBMIT, SUBMIT, TOUCH, UNREGISTER_FIELD, UNTOUCH, UPDATE_SYNC_ERRORS, UPDATE_SYNC_WARNINGS } from './actionTypes';\nimport 'array-findindex-polyfill';\nimport createDeleteInWithCleanUp from './deleteInWithCleanUp';\n\nvar createReducer = function createReducer(structure) {\n  var _behaviors;\n\n  var deepEqual = structure.deepEqual,\n      empty = structure.empty,\n      getIn = structure.getIn,\n      setIn = structure.setIn,\n      deleteIn = structure.deleteIn,\n      fromJS = structure.fromJS,\n      size = structure.size,\n      some = structure.some,\n      splice = structure.splice;\n  var deleteInWithCleanUp = createDeleteInWithCleanUp(structure);\n\n  var doSplice = function doSplice(state, key, field, index, removeNum, value, force) {\n    var existing = getIn(state, key + '.' + field);\n    return existing || force ? setIn(state, key + '.' + field, splice(existing, index, removeNum, value)) : state;\n  };\n\n  var rootKeys = ['values', 'fields', 'submitErrors', 'asyncErrors'];\n\n  var arraySplice = function arraySplice(state, field, index, removeNum, value) {\n    var result = state;\n    var nonValuesValue = value != null ? empty : undefined;\n    result = doSplice(result, 'values', field, index, removeNum, value, true);\n    result = doSplice(result, 'fields', field, index, removeNum, nonValuesValue);\n    result = doSplice(result, 'submitErrors', field, index, removeNum, nonValuesValue);\n    result = doSplice(result, 'asyncErrors', field, index, removeNum, nonValuesValue);\n    return result;\n  };\n\n  var behaviors = (_behaviors = {}, _defineProperty(_behaviors, ARRAY_INSERT, function (state, _ref) {\n    var _ref$meta = _ref.meta,\n        field = _ref$meta.field,\n        index = _ref$meta.index,\n        payload = _ref.payload;\n    return arraySplice(state, field, index, 0, payload);\n  }), _defineProperty(_behaviors, ARRAY_MOVE, function (state, _ref2) {\n    var _ref2$meta = _ref2.meta,\n        field = _ref2$meta.field,\n        from = _ref2$meta.from,\n        to = _ref2$meta.to;\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    var result = state;\n\n    if (length) {\n      rootKeys.forEach(function (key) {\n        var path = key + '.' + field;\n\n        if (getIn(result, path)) {\n          var value = getIn(result, path + '[' + from + ']');\n          result = setIn(result, path, splice(getIn(result, path), from, 1)); // remove\n\n          result = setIn(result, path, splice(getIn(result, path), to, 0, value)); // insert\n        }\n      });\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, ARRAY_POP, function (state, _ref3) {\n    var field = _ref3.meta.field;\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    return length ? arraySplice(state, field, length - 1, 1) : state;\n  }), _defineProperty(_behaviors, ARRAY_PUSH, function (state, _ref4) {\n    var field = _ref4.meta.field,\n        payload = _ref4.payload;\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    return arraySplice(state, field, length, 0, payload);\n  }), _defineProperty(_behaviors, ARRAY_REMOVE, function (state, _ref5) {\n    var _ref5$meta = _ref5.meta,\n        field = _ref5$meta.field,\n        index = _ref5$meta.index;\n    return arraySplice(state, field, index, 1);\n  }), _defineProperty(_behaviors, ARRAY_REMOVE_ALL, function (state, _ref6) {\n    var field = _ref6.meta.field;\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    return length ? arraySplice(state, field, 0, length) : state;\n  }), _defineProperty(_behaviors, ARRAY_SHIFT, function (state, _ref7) {\n    var field = _ref7.meta.field;\n    return arraySplice(state, field, 0, 1);\n  }), _defineProperty(_behaviors, ARRAY_SPLICE, function (state, _ref8) {\n    var _ref8$meta = _ref8.meta,\n        field = _ref8$meta.field,\n        index = _ref8$meta.index,\n        removeNum = _ref8$meta.removeNum,\n        payload = _ref8.payload;\n    return arraySplice(state, field, index, removeNum, payload);\n  }), _defineProperty(_behaviors, ARRAY_SWAP, function (state, _ref9) {\n    var _ref9$meta = _ref9.meta,\n        field = _ref9$meta.field,\n        indexA = _ref9$meta.indexA,\n        indexB = _ref9$meta.indexB;\n    var result = state;\n    rootKeys.forEach(function (key) {\n      var valueA = getIn(result, key + '.' + field + '[' + indexA + ']');\n      var valueB = getIn(result, key + '.' + field + '[' + indexB + ']');\n\n      if (valueA !== undefined || valueB !== undefined) {\n        result = setIn(result, key + '.' + field + '[' + indexA + ']', valueB);\n        result = setIn(result, key + '.' + field + '[' + indexB + ']', valueA);\n      }\n    });\n    return result;\n  }), _defineProperty(_behaviors, ARRAY_UNSHIFT, function (state, _ref10) {\n    var field = _ref10.meta.field,\n        payload = _ref10.payload;\n    return arraySplice(state, field, 0, 0, payload);\n  }), _defineProperty(_behaviors, AUTOFILL, function (state, _ref11) {\n    var field = _ref11.meta.field,\n        payload = _ref11.payload;\n    var result = state;\n    result = deleteInWithCleanUp(result, 'asyncErrors.' + field);\n    result = deleteInWithCleanUp(result, 'submitErrors.' + field);\n    result = setIn(result, 'fields.' + field + '.autofilled', true);\n    result = setIn(result, 'values.' + field, payload);\n    return result;\n  }), _defineProperty(_behaviors, BLUR, function (state, _ref12) {\n    var _ref12$meta = _ref12.meta,\n        field = _ref12$meta.field,\n        touch = _ref12$meta.touch,\n        payload = _ref12.payload;\n    var result = state;\n    var initial = getIn(result, 'initial.' + field);\n\n    if (initial === undefined && payload === '') {\n      result = deleteInWithCleanUp(result, 'values.' + field);\n    } else if (payload !== undefined) {\n      result = setIn(result, 'values.' + field, payload);\n    }\n\n    if (field === getIn(result, 'active')) {\n      result = deleteIn(result, 'active');\n    }\n\n    result = deleteIn(result, 'fields.' + field + '.active');\n\n    if (touch) {\n      result = setIn(result, 'fields.' + field + '.touched', true);\n      result = setIn(result, 'anyTouched', true);\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, CHANGE, function (state, _ref13) {\n    var _ref13$meta = _ref13.meta,\n        field = _ref13$meta.field,\n        touch = _ref13$meta.touch,\n        persistentSubmitErrors = _ref13$meta.persistentSubmitErrors,\n        payload = _ref13.payload;\n    var result = state;\n    var initial = getIn(result, 'initial.' + field);\n\n    if (initial === undefined && payload === '') {\n      result = deleteInWithCleanUp(result, 'values.' + field);\n    } else if (payload !== undefined) {\n      result = setIn(result, 'values.' + field, payload);\n    }\n\n    result = deleteInWithCleanUp(result, 'asyncErrors.' + field);\n\n    if (!persistentSubmitErrors) {\n      result = deleteInWithCleanUp(result, 'submitErrors.' + field);\n    }\n\n    result = deleteInWithCleanUp(result, 'fields.' + field + '.autofilled');\n\n    if (touch) {\n      result = setIn(result, 'fields.' + field + '.touched', true);\n      result = setIn(result, 'anyTouched', true);\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, CLEAR_SUBMIT, function (state) {\n    return deleteIn(state, 'triggerSubmit');\n  }), _defineProperty(_behaviors, CLEAR_ASYNC_ERROR, function (state, _ref14) {\n    var field = _ref14.meta.field;\n    return deleteIn(state, 'asyncErrors.' + field);\n  }), _defineProperty(_behaviors, FOCUS, function (state, _ref15) {\n    var field = _ref15.meta.field;\n    var result = state;\n    var previouslyActive = getIn(state, 'active');\n    result = deleteIn(result, 'fields.' + previouslyActive + '.active');\n    result = setIn(result, 'fields.' + field + '.visited', true);\n    result = setIn(result, 'fields.' + field + '.active', true);\n    result = setIn(result, 'active', field);\n    return result;\n  }), _defineProperty(_behaviors, INITIALIZE, function (state, _ref16) {\n    var payload = _ref16.payload,\n        keepDirty = _ref16.meta.keepDirty;\n    var mapData = fromJS(payload);\n    var result = empty; // clean all field state\n    // persist old warnings, they will get recalculated if the new form values are different from the old values\n\n    var warning = getIn(state, 'warning');\n\n    if (warning) {\n      result = setIn(result, 'warning', warning);\n    }\n\n    var syncWarnings = getIn(state, 'syncWarnings');\n\n    if (syncWarnings) {\n      result = setIn(result, 'syncWarnings', syncWarnings);\n    } // persist old errors, they will get recalculated if the new form values are different from the old values\n\n\n    var error = getIn(state, 'error');\n\n    if (error) {\n      result = setIn(result, 'error', error);\n    }\n\n    var syncErrors = getIn(state, 'syncErrors');\n\n    if (syncErrors) {\n      result = setIn(result, 'syncErrors', syncErrors);\n    }\n\n    var registeredFields = getIn(state, 'registeredFields');\n\n    if (registeredFields) {\n      result = setIn(result, 'registeredFields', registeredFields);\n    }\n\n    var newValues = mapData;\n\n    if (keepDirty && registeredFields) {\n      (function () {\n        //\n        // Keep the value of dirty fields while updating the value of\n        // pristine fields. This way, apps can reinitialize forms while\n        // avoiding stomping on user edits.\n        //\n        // Note 1: The initialize action replaces all initial values\n        // regardless of keepDirty.\n        //\n        // Note 2: When a field is dirty, keepDirty is enabled, and the field\n        // value is the same as the new initial value for the field, the\n        // initialize action causes the field to become pristine. That effect\n        // is what we want.\n        //\n        var previousValues = getIn(state, 'values');\n        var previousInitialValues = getIn(state, 'initial');\n        registeredFields.forEach(function (field) {\n          var name = getIn(field, 'name');\n          var previousInitialValue = getIn(previousInitialValues, name);\n          var previousValue = getIn(previousValues, name);\n\n          if (!deepEqual(previousValue, previousInitialValue)) {\n            // This field was dirty. Restore the dirty value.\n            newValues = setIn(newValues, name, previousValue);\n          }\n        });\n      })();\n    }\n\n    result = setIn(result, 'values', newValues);\n    result = setIn(result, 'initial', mapData);\n    return result;\n  }), _defineProperty(_behaviors, REGISTER_FIELD, function (state, _ref17) {\n    var _ref17$payload = _ref17.payload,\n        name = _ref17$payload.name,\n        type = _ref17$payload.type;\n    var result = state;\n    var registeredFields = getIn(result, 'registeredFields');\n\n    if (some(registeredFields, function (field) {\n      return getIn(field, 'name') === name;\n    })) {\n      return state;\n    }\n\n    var mapData = fromJS({\n      name: name,\n      type: type\n    });\n    result = setIn(state, 'registeredFields', splice(registeredFields, size(registeredFields), 0, mapData));\n    return result;\n  }), _defineProperty(_behaviors, RESET, function (state) {\n    var result = empty;\n    var registeredFields = getIn(state, 'registeredFields');\n\n    if (registeredFields) {\n      result = setIn(result, 'registeredFields', registeredFields);\n    }\n\n    var values = getIn(state, 'initial');\n\n    if (values) {\n      result = setIn(result, 'values', values);\n      result = setIn(result, 'initial', values);\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, SUBMIT, function (state) {\n    return setIn(state, 'triggerSubmit', true);\n  }), _defineProperty(_behaviors, START_ASYNC_VALIDATION, function (state, _ref18) {\n    var field = _ref18.meta.field;\n    return setIn(state, 'asyncValidating', field || true);\n  }), _defineProperty(_behaviors, START_SUBMIT, function (state) {\n    return setIn(state, 'submitting', true);\n  }), _defineProperty(_behaviors, STOP_ASYNC_VALIDATION, function (state, _ref19) {\n    var payload = _ref19.payload;\n    var result = state;\n    result = deleteIn(result, 'asyncValidating');\n\n    if (payload && Object.keys(payload).length) {\n      var _error = payload._error,\n          fieldErrors = _objectWithoutProperties(payload, ['_error']);\n\n      if (_error) {\n        result = setIn(result, 'error', _error);\n      }\n\n      if (Object.keys(fieldErrors).length) {\n        result = setIn(result, 'asyncErrors', fromJS(fieldErrors));\n      } else {\n        result = deleteIn(result, 'asyncErrors');\n      }\n    } else {\n      result = deleteIn(result, 'error');\n      result = deleteIn(result, 'asyncErrors');\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, STOP_SUBMIT, function (state, _ref20) {\n    var payload = _ref20.payload;\n    var result = state;\n    result = deleteIn(result, 'submitting');\n    result = deleteIn(result, 'submitFailed');\n    result = deleteIn(result, 'submitSucceeded');\n\n    if (payload && Object.keys(payload).length) {\n      var _error = payload._error,\n          fieldErrors = _objectWithoutProperties(payload, ['_error']);\n\n      if (_error) {\n        result = setIn(result, 'error', _error);\n      } else {\n        result = deleteIn(result, 'error');\n      }\n\n      if (Object.keys(fieldErrors).length) {\n        result = setIn(result, 'submitErrors', fromJS(fieldErrors));\n      } else {\n        result = deleteIn(result, 'submitErrors');\n      }\n\n      result = setIn(result, 'submitFailed', true);\n    } else {\n      result = setIn(result, 'submitSucceeded', true);\n      result = deleteIn(result, 'error');\n      result = deleteIn(result, 'submitErrors');\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, SET_SUBMIT_FAILED, function (state, _ref21) {\n    var fields = _ref21.meta.fields;\n    var result = state;\n    result = setIn(result, 'submitFailed', true);\n    result = deleteIn(result, 'submitSucceeded');\n    result = deleteIn(result, 'submitting');\n    fields.forEach(function (field) {\n      return result = setIn(result, 'fields.' + field + '.touched', true);\n    });\n\n    if (fields.length) {\n      result = setIn(result, 'anyTouched', true);\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, SET_SUBMIT_SUCCEEDED, function (state) {\n    var result = state;\n    result = deleteIn(result, 'submitFailed');\n    result = setIn(result, 'submitSucceeded', true);\n    return result;\n  }), _defineProperty(_behaviors, TOUCH, function (state, _ref22) {\n    var fields = _ref22.meta.fields;\n    var result = state;\n    fields.forEach(function (field) {\n      return result = setIn(result, 'fields.' + field + '.touched', true);\n    });\n    result = setIn(result, 'anyTouched', true);\n    return result;\n  }), _defineProperty(_behaviors, UNREGISTER_FIELD, function (state, _ref23) {\n    var name = _ref23.payload.name;\n    var registeredFields = getIn(state, 'registeredFields'); // in case the form was destroyed and registeredFields no longer exists\n\n    if (!registeredFields) {\n      return state;\n    }\n\n    var fieldIndex = registeredFields.findIndex(function (value) {\n      return getIn(value, 'name') === name;\n    });\n\n    if (size(registeredFields) <= 1 && fieldIndex >= 0) {\n      return deleteInWithCleanUp(state, 'registeredFields');\n    }\n\n    if (fieldIndex < 0) {\n      return state;\n    }\n\n    return setIn(state, 'registeredFields', splice(registeredFields, fieldIndex, 1));\n  }), _defineProperty(_behaviors, UNTOUCH, function (state, _ref24) {\n    var fields = _ref24.meta.fields;\n    var result = state;\n    fields.forEach(function (field) {\n      return result = deleteIn(result, 'fields.' + field + '.touched');\n    });\n    return result;\n  }), _defineProperty(_behaviors, UPDATE_SYNC_ERRORS, function (state, _ref25) {\n    var _ref25$payload = _ref25.payload,\n        syncErrors = _ref25$payload.syncErrors,\n        error = _ref25$payload.error;\n    var result = state;\n\n    if (error) {\n      result = setIn(result, 'error', error);\n      result = setIn(result, 'syncError', true);\n    } else {\n      result = deleteIn(result, 'error');\n      result = deleteIn(result, 'syncError');\n    }\n\n    if (Object.keys(syncErrors).length) {\n      result = setIn(result, 'syncErrors', syncErrors);\n    } else {\n      result = deleteIn(result, 'syncErrors');\n    }\n\n    return result;\n  }), _defineProperty(_behaviors, UPDATE_SYNC_WARNINGS, function (state, _ref26) {\n    var _ref26$payload = _ref26.payload,\n        syncWarnings = _ref26$payload.syncWarnings,\n        warning = _ref26$payload.warning;\n    var result = state;\n\n    if (warning) {\n      result = setIn(result, 'warning', warning);\n    } else {\n      result = deleteIn(result, 'warning');\n    }\n\n    if (Object.keys(syncWarnings).length) {\n      result = setIn(result, 'syncWarnings', syncWarnings);\n    } else {\n      result = deleteIn(result, 'syncWarnings');\n    }\n\n    return result;\n  }), _behaviors);\n\n  var reducer = function reducer() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : empty;\n    var action = arguments[1];\n    var behavior = behaviors[action.type];\n    return behavior ? behavior(state, action) : state;\n  };\n\n  var byForm = function byForm(reducer) {\n    return function () {\n      var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : empty;\n      var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var form = action && action.meta && action.meta.form;\n\n      if (!form) {\n        return state;\n      }\n\n      if (action.type === DESTROY) {\n        return deleteInWithCleanUp(state, action.meta.form);\n      }\n\n      var formState = getIn(state, form);\n      var result = reducer(formState, action);\n      return result === formState ? state : setIn(state, form, result);\n    };\n  };\n  /**\n   * Adds additional functionality to the reducer\n   */\n\n\n  function decorate(target) {\n    target.plugin = function plugin(reducers) {\n      var _this = this; // use 'function' keyword to enable 'this'\n\n\n      return decorate(function () {\n        var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : empty;\n        var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        return Object.keys(reducers).reduce(function (accumulator, key) {\n          var previousState = getIn(accumulator, key);\n          var nextState = reducers[key](previousState, action, getIn(state, key));\n          return nextState === previousState ? accumulator : setIn(accumulator, key, nextState);\n        }, _this(state, action));\n      });\n    };\n\n    return target;\n  }\n\n  return decorate(byForm(reducer));\n};\n\nexport default createReducer;","map":{"version":3,"sources":["C:/Users/Naveen/Desktop/Final/FEEngineer_Assignment/coding-test/node_modules/redux-form-immutable/es/reducer.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_objectWithoutProperties","keys","target","i","indexOf","prototype","hasOwnProperty","call","ARRAY_INSERT","ARRAY_MOVE","ARRAY_POP","ARRAY_PUSH","ARRAY_REMOVE","ARRAY_REMOVE_ALL","ARRAY_SHIFT","ARRAY_SPLICE","ARRAY_SWAP","ARRAY_UNSHIFT","AUTOFILL","BLUR","CHANGE","CLEAR_SUBMIT","CLEAR_ASYNC_ERROR","DESTROY","FOCUS","INITIALIZE","REGISTER_FIELD","RESET","SET_SUBMIT_FAILED","SET_SUBMIT_SUCCEEDED","START_ASYNC_VALIDATION","START_SUBMIT","STOP_ASYNC_VALIDATION","STOP_SUBMIT","SUBMIT","TOUCH","UNREGISTER_FIELD","UNTOUCH","UPDATE_SYNC_ERRORS","UPDATE_SYNC_WARNINGS","createDeleteInWithCleanUp","createReducer","structure","_behaviors","deepEqual","empty","getIn","setIn","deleteIn","fromJS","size","some","splice","deleteInWithCleanUp","doSplice","state","field","index","removeNum","force","existing","rootKeys","arraySplice","result","nonValuesValue","undefined","behaviors","_ref","_ref$meta","meta","payload","_ref2","_ref2$meta","from","to","array","length","forEach","path","_ref3","_ref4","_ref5","_ref5$meta","_ref6","_ref7","_ref8","_ref8$meta","_ref9","_ref9$meta","indexA","indexB","valueA","valueB","_ref10","_ref11","_ref12","_ref12$meta","touch","initial","_ref13","_ref13$meta","persistentSubmitErrors","_ref14","_ref15","previouslyActive","_ref16","keepDirty","mapData","warning","syncWarnings","error","syncErrors","registeredFields","newValues","previousValues","previousInitialValues","name","previousInitialValue","previousValue","_ref17","_ref17$payload","type","values","_ref18","_ref19","_error","fieldErrors","_ref20","_ref21","fields","_ref22","_ref23","fieldIndex","findIndex","_ref24","_ref25","_ref25$payload","_ref26","_ref26$payload","reducer","arguments","action","behavior","byForm","form","formState","decorate","plugin","reducers","_this","reduce","accumulator","previousState","nextState"],"mappings":"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","sourcesContent":["function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport { ARRAY_INSERT, ARRAY_MOVE, ARRAY_POP, ARRAY_PUSH, ARRAY_REMOVE, ARRAY_REMOVE_ALL, ARRAY_SHIFT, ARRAY_SPLICE, ARRAY_SWAP, ARRAY_UNSHIFT, AUTOFILL, BLUR, CHANGE, CLEAR_SUBMIT, CLEAR_ASYNC_ERROR, DESTROY, FOCUS, INITIALIZE, REGISTER_FIELD, RESET, SET_SUBMIT_FAILED, SET_SUBMIT_SUCCEEDED, START_ASYNC_VALIDATION, START_SUBMIT, STOP_ASYNC_VALIDATION, STOP_SUBMIT, SUBMIT, TOUCH, UNREGISTER_FIELD, UNTOUCH, UPDATE_SYNC_ERRORS, UPDATE_SYNC_WARNINGS } from './actionTypes';\nimport 'array-findindex-polyfill';\nimport createDeleteInWithCleanUp from './deleteInWithCleanUp';\n\nvar createReducer = function createReducer(structure) {\n  var _behaviors;\n\n  var deepEqual = structure.deepEqual,\n      empty = structure.empty,\n      getIn = structure.getIn,\n      setIn = structure.setIn,\n      deleteIn = structure.deleteIn,\n      fromJS = structure.fromJS,\n      size = structure.size,\n      some = structure.some,\n      splice = structure.splice;\n\n  var deleteInWithCleanUp = createDeleteInWithCleanUp(structure);\n  var doSplice = function doSplice(state, key, field, index, removeNum, value, force) {\n    var existing = getIn(state, key + '.' + field);\n    return existing || force ? setIn(state, key + '.' + field, splice(existing, index, removeNum, value)) : state;\n  };\n  var rootKeys = ['values', 'fields', 'submitErrors', 'asyncErrors'];\n  var arraySplice = function arraySplice(state, field, index, removeNum, value) {\n    var result = state;\n    var nonValuesValue = value != null ? empty : undefined;\n    result = doSplice(result, 'values', field, index, removeNum, value, true);\n    result = doSplice(result, 'fields', field, index, removeNum, nonValuesValue);\n    result = doSplice(result, 'submitErrors', field, index, removeNum, nonValuesValue);\n    result = doSplice(result, 'asyncErrors', field, index, removeNum, nonValuesValue);\n    return result;\n  };\n\n  var behaviors = (_behaviors = {}, _defineProperty(_behaviors, ARRAY_INSERT, function (state, _ref) {\n    var _ref$meta = _ref.meta,\n        field = _ref$meta.field,\n        index = _ref$meta.index,\n        payload = _ref.payload;\n\n    return arraySplice(state, field, index, 0, payload);\n  }), _defineProperty(_behaviors, ARRAY_MOVE, function (state, _ref2) {\n    var _ref2$meta = _ref2.meta,\n        field = _ref2$meta.field,\n        from = _ref2$meta.from,\n        to = _ref2$meta.to;\n\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    var result = state;\n    if (length) {\n      rootKeys.forEach(function (key) {\n        var path = key + '.' + field;\n        if (getIn(result, path)) {\n          var value = getIn(result, path + '[' + from + ']');\n          result = setIn(result, path, splice(getIn(result, path), from, 1)); // remove\n          result = setIn(result, path, splice(getIn(result, path), to, 0, value)); // insert\n        }\n      });\n    }\n    return result;\n  }), _defineProperty(_behaviors, ARRAY_POP, function (state, _ref3) {\n    var field = _ref3.meta.field;\n\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    return length ? arraySplice(state, field, length - 1, 1) : state;\n  }), _defineProperty(_behaviors, ARRAY_PUSH, function (state, _ref4) {\n    var field = _ref4.meta.field,\n        payload = _ref4.payload;\n\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    return arraySplice(state, field, length, 0, payload);\n  }), _defineProperty(_behaviors, ARRAY_REMOVE, function (state, _ref5) {\n    var _ref5$meta = _ref5.meta,\n        field = _ref5$meta.field,\n        index = _ref5$meta.index;\n\n    return arraySplice(state, field, index, 1);\n  }), _defineProperty(_behaviors, ARRAY_REMOVE_ALL, function (state, _ref6) {\n    var field = _ref6.meta.field;\n\n    var array = getIn(state, 'values.' + field);\n    var length = array ? size(array) : 0;\n    return length ? arraySplice(state, field, 0, length) : state;\n  }), _defineProperty(_behaviors, ARRAY_SHIFT, function (state, _ref7) {\n    var field = _ref7.meta.field;\n\n    return arraySplice(state, field, 0, 1);\n  }), _defineProperty(_behaviors, ARRAY_SPLICE, function (state, _ref8) {\n    var _ref8$meta = _ref8.meta,\n        field = _ref8$meta.field,\n        index = _ref8$meta.index,\n        removeNum = _ref8$meta.removeNum,\n        payload = _ref8.payload;\n\n    return arraySplice(state, field, index, removeNum, payload);\n  }), _defineProperty(_behaviors, ARRAY_SWAP, function (state, _ref9) {\n    var _ref9$meta = _ref9.meta,\n        field = _ref9$meta.field,\n        indexA = _ref9$meta.indexA,\n        indexB = _ref9$meta.indexB;\n\n    var result = state;\n    rootKeys.forEach(function (key) {\n      var valueA = getIn(result, key + '.' + field + '[' + indexA + ']');\n      var valueB = getIn(result, key + '.' + field + '[' + indexB + ']');\n      if (valueA !== undefined || valueB !== undefined) {\n        result = setIn(result, key + '.' + field + '[' + indexA + ']', valueB);\n        result = setIn(result, key + '.' + field + '[' + indexB + ']', valueA);\n      }\n    });\n    return result;\n  }), _defineProperty(_behaviors, ARRAY_UNSHIFT, function (state, _ref10) {\n    var field = _ref10.meta.field,\n        payload = _ref10.payload;\n\n    return arraySplice(state, field, 0, 0, payload);\n  }), _defineProperty(_behaviors, AUTOFILL, function (state, _ref11) {\n    var field = _ref11.meta.field,\n        payload = _ref11.payload;\n\n    var result = state;\n    result = deleteInWithCleanUp(result, 'asyncErrors.' + field);\n    result = deleteInWithCleanUp(result, 'submitErrors.' + field);\n    result = setIn(result, 'fields.' + field + '.autofilled', true);\n    result = setIn(result, 'values.' + field, payload);\n    return result;\n  }), _defineProperty(_behaviors, BLUR, function (state, _ref12) {\n    var _ref12$meta = _ref12.meta,\n        field = _ref12$meta.field,\n        touch = _ref12$meta.touch,\n        payload = _ref12.payload;\n\n    var result = state;\n    var initial = getIn(result, 'initial.' + field);\n    if (initial === undefined && payload === '') {\n      result = deleteInWithCleanUp(result, 'values.' + field);\n    } else if (payload !== undefined) {\n      result = setIn(result, 'values.' + field, payload);\n    }\n    if (field === getIn(result, 'active')) {\n      result = deleteIn(result, 'active');\n    }\n    result = deleteIn(result, 'fields.' + field + '.active');\n    if (touch) {\n      result = setIn(result, 'fields.' + field + '.touched', true);\n      result = setIn(result, 'anyTouched', true);\n    }\n    return result;\n  }), _defineProperty(_behaviors, CHANGE, function (state, _ref13) {\n    var _ref13$meta = _ref13.meta,\n        field = _ref13$meta.field,\n        touch = _ref13$meta.touch,\n        persistentSubmitErrors = _ref13$meta.persistentSubmitErrors,\n        payload = _ref13.payload;\n\n    var result = state;\n    var initial = getIn(result, 'initial.' + field);\n    if (initial === undefined && payload === '') {\n      result = deleteInWithCleanUp(result, 'values.' + field);\n    } else if (payload !== undefined) {\n      result = setIn(result, 'values.' + field, payload);\n    }\n    result = deleteInWithCleanUp(result, 'asyncErrors.' + field);\n    if (!persistentSubmitErrors) {\n      result = deleteInWithCleanUp(result, 'submitErrors.' + field);\n    }\n    result = deleteInWithCleanUp(result, 'fields.' + field + '.autofilled');\n    if (touch) {\n      result = setIn(result, 'fields.' + field + '.touched', true);\n      result = setIn(result, 'anyTouched', true);\n    }\n    return result;\n  }), _defineProperty(_behaviors, CLEAR_SUBMIT, function (state) {\n    return deleteIn(state, 'triggerSubmit');\n  }), _defineProperty(_behaviors, CLEAR_ASYNC_ERROR, function (state, _ref14) {\n    var field = _ref14.meta.field;\n\n    return deleteIn(state, 'asyncErrors.' + field);\n  }), _defineProperty(_behaviors, FOCUS, function (state, _ref15) {\n    var field = _ref15.meta.field;\n\n    var result = state;\n    var previouslyActive = getIn(state, 'active');\n    result = deleteIn(result, 'fields.' + previouslyActive + '.active');\n    result = setIn(result, 'fields.' + field + '.visited', true);\n    result = setIn(result, 'fields.' + field + '.active', true);\n    result = setIn(result, 'active', field);\n    return result;\n  }), _defineProperty(_behaviors, INITIALIZE, function (state, _ref16) {\n    var payload = _ref16.payload,\n        keepDirty = _ref16.meta.keepDirty;\n\n    var mapData = fromJS(payload);\n    var result = empty; // clean all field state\n\n    // persist old warnings, they will get recalculated if the new form values are different from the old values\n    var warning = getIn(state, 'warning');\n    if (warning) {\n      result = setIn(result, 'warning', warning);\n    }\n    var syncWarnings = getIn(state, 'syncWarnings');\n    if (syncWarnings) {\n      result = setIn(result, 'syncWarnings', syncWarnings);\n    }\n\n    // persist old errors, they will get recalculated if the new form values are different from the old values\n    var error = getIn(state, 'error');\n    if (error) {\n      result = setIn(result, 'error', error);\n    }\n    var syncErrors = getIn(state, 'syncErrors');\n    if (syncErrors) {\n      result = setIn(result, 'syncErrors', syncErrors);\n    }\n\n    var registeredFields = getIn(state, 'registeredFields');\n    if (registeredFields) {\n      result = setIn(result, 'registeredFields', registeredFields);\n    }\n    var newValues = mapData;\n    if (keepDirty && registeredFields) {\n      (function () {\n        //\n        // Keep the value of dirty fields while updating the value of\n        // pristine fields. This way, apps can reinitialize forms while\n        // avoiding stomping on user edits.\n        //\n        // Note 1: The initialize action replaces all initial values\n        // regardless of keepDirty.\n        //\n        // Note 2: When a field is dirty, keepDirty is enabled, and the field\n        // value is the same as the new initial value for the field, the\n        // initialize action causes the field to become pristine. That effect\n        // is what we want.\n        //\n        var previousValues = getIn(state, 'values');\n        var previousInitialValues = getIn(state, 'initial');\n        registeredFields.forEach(function (field) {\n          var name = getIn(field, 'name');\n          var previousInitialValue = getIn(previousInitialValues, name);\n          var previousValue = getIn(previousValues, name);\n          if (!deepEqual(previousValue, previousInitialValue)) {\n            // This field was dirty. Restore the dirty value.\n            newValues = setIn(newValues, name, previousValue);\n          }\n        });\n      })();\n    }\n    result = setIn(result, 'values', newValues);\n    result = setIn(result, 'initial', mapData);\n    return result;\n  }), _defineProperty(_behaviors, REGISTER_FIELD, function (state, _ref17) {\n    var _ref17$payload = _ref17.payload,\n        name = _ref17$payload.name,\n        type = _ref17$payload.type;\n\n    var result = state;\n    var registeredFields = getIn(result, 'registeredFields');\n    if (some(registeredFields, function (field) {\n      return getIn(field, 'name') === name;\n    })) {\n      return state;\n    }\n\n    var mapData = fromJS({ name: name, type: type });\n    result = setIn(state, 'registeredFields', splice(registeredFields, size(registeredFields), 0, mapData));\n    return result;\n  }), _defineProperty(_behaviors, RESET, function (state) {\n    var result = empty;\n    var registeredFields = getIn(state, 'registeredFields');\n    if (registeredFields) {\n      result = setIn(result, 'registeredFields', registeredFields);\n    }\n    var values = getIn(state, 'initial');\n    if (values) {\n      result = setIn(result, 'values', values);\n      result = setIn(result, 'initial', values);\n    }\n    return result;\n  }), _defineProperty(_behaviors, SUBMIT, function (state) {\n    return setIn(state, 'triggerSubmit', true);\n  }), _defineProperty(_behaviors, START_ASYNC_VALIDATION, function (state, _ref18) {\n    var field = _ref18.meta.field;\n\n    return setIn(state, 'asyncValidating', field || true);\n  }), _defineProperty(_behaviors, START_SUBMIT, function (state) {\n    return setIn(state, 'submitting', true);\n  }), _defineProperty(_behaviors, STOP_ASYNC_VALIDATION, function (state, _ref19) {\n    var payload = _ref19.payload;\n\n    var result = state;\n    result = deleteIn(result, 'asyncValidating');\n    if (payload && Object.keys(payload).length) {\n      var _error = payload._error,\n          fieldErrors = _objectWithoutProperties(payload, ['_error']);\n\n      if (_error) {\n        result = setIn(result, 'error', _error);\n      }\n      if (Object.keys(fieldErrors).length) {\n        result = setIn(result, 'asyncErrors', fromJS(fieldErrors));\n      } else {\n        result = deleteIn(result, 'asyncErrors');\n      }\n    } else {\n      result = deleteIn(result, 'error');\n      result = deleteIn(result, 'asyncErrors');\n    }\n    return result;\n  }), _defineProperty(_behaviors, STOP_SUBMIT, function (state, _ref20) {\n    var payload = _ref20.payload;\n\n    var result = state;\n    result = deleteIn(result, 'submitting');\n    result = deleteIn(result, 'submitFailed');\n    result = deleteIn(result, 'submitSucceeded');\n    if (payload && Object.keys(payload).length) {\n      var _error = payload._error,\n          fieldErrors = _objectWithoutProperties(payload, ['_error']);\n\n      if (_error) {\n        result = setIn(result, 'error', _error);\n      } else {\n        result = deleteIn(result, 'error');\n      }\n      if (Object.keys(fieldErrors).length) {\n        result = setIn(result, 'submitErrors', fromJS(fieldErrors));\n      } else {\n        result = deleteIn(result, 'submitErrors');\n      }\n      result = setIn(result, 'submitFailed', true);\n    } else {\n      result = setIn(result, 'submitSucceeded', true);\n      result = deleteIn(result, 'error');\n      result = deleteIn(result, 'submitErrors');\n    }\n    return result;\n  }), _defineProperty(_behaviors, SET_SUBMIT_FAILED, function (state, _ref21) {\n    var fields = _ref21.meta.fields;\n\n    var result = state;\n    result = setIn(result, 'submitFailed', true);\n    result = deleteIn(result, 'submitSucceeded');\n    result = deleteIn(result, 'submitting');\n    fields.forEach(function (field) {\n      return result = setIn(result, 'fields.' + field + '.touched', true);\n    });\n    if (fields.length) {\n      result = setIn(result, 'anyTouched', true);\n    }\n    return result;\n  }), _defineProperty(_behaviors, SET_SUBMIT_SUCCEEDED, function (state) {\n    var result = state;\n    result = deleteIn(result, 'submitFailed');\n    result = setIn(result, 'submitSucceeded', true);\n    return result;\n  }), _defineProperty(_behaviors, TOUCH, function (state, _ref22) {\n    var fields = _ref22.meta.fields;\n\n    var result = state;\n    fields.forEach(function (field) {\n      return result = setIn(result, 'fields.' + field + '.touched', true);\n    });\n    result = setIn(result, 'anyTouched', true);\n    return result;\n  }), _defineProperty(_behaviors, UNREGISTER_FIELD, function (state, _ref23) {\n    var name = _ref23.payload.name;\n\n    var registeredFields = getIn(state, 'registeredFields');\n\n    // in case the form was destroyed and registeredFields no longer exists\n    if (!registeredFields) {\n      return state;\n    }\n\n    var fieldIndex = registeredFields.findIndex(function (value) {\n      return getIn(value, 'name') === name;\n    });\n    if (size(registeredFields) <= 1 && fieldIndex >= 0) {\n      return deleteInWithCleanUp(state, 'registeredFields');\n    }\n    if (fieldIndex < 0) {\n      return state;\n    }\n    return setIn(state, 'registeredFields', splice(registeredFields, fieldIndex, 1));\n  }), _defineProperty(_behaviors, UNTOUCH, function (state, _ref24) {\n    var fields = _ref24.meta.fields;\n\n    var result = state;\n    fields.forEach(function (field) {\n      return result = deleteIn(result, 'fields.' + field + '.touched');\n    });\n    return result;\n  }), _defineProperty(_behaviors, UPDATE_SYNC_ERRORS, function (state, _ref25) {\n    var _ref25$payload = _ref25.payload,\n        syncErrors = _ref25$payload.syncErrors,\n        error = _ref25$payload.error;\n\n    var result = state;\n    if (error) {\n      result = setIn(result, 'error', error);\n      result = setIn(result, 'syncError', true);\n    } else {\n      result = deleteIn(result, 'error');\n      result = deleteIn(result, 'syncError');\n    }\n    if (Object.keys(syncErrors).length) {\n      result = setIn(result, 'syncErrors', syncErrors);\n    } else {\n      result = deleteIn(result, 'syncErrors');\n    }\n    return result;\n  }), _defineProperty(_behaviors, UPDATE_SYNC_WARNINGS, function (state, _ref26) {\n    var _ref26$payload = _ref26.payload,\n        syncWarnings = _ref26$payload.syncWarnings,\n        warning = _ref26$payload.warning;\n\n    var result = state;\n    if (warning) {\n      result = setIn(result, 'warning', warning);\n    } else {\n      result = deleteIn(result, 'warning');\n    }\n    if (Object.keys(syncWarnings).length) {\n      result = setIn(result, 'syncWarnings', syncWarnings);\n    } else {\n      result = deleteIn(result, 'syncWarnings');\n    }\n    return result;\n  }), _behaviors);\n\n  var reducer = function reducer() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : empty;\n    var action = arguments[1];\n\n    var behavior = behaviors[action.type];\n    return behavior ? behavior(state, action) : state;\n  };\n\n  var byForm = function byForm(reducer) {\n    return function () {\n      var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : empty;\n      var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var form = action && action.meta && action.meta.form;\n      if (!form) {\n        return state;\n      }\n      if (action.type === DESTROY) {\n        return deleteInWithCleanUp(state, action.meta.form);\n      }\n      var formState = getIn(state, form);\n      var result = reducer(formState, action);\n      return result === formState ? state : setIn(state, form, result);\n    };\n  };\n\n  /**\n   * Adds additional functionality to the reducer\n   */\n  function decorate(target) {\n    target.plugin = function plugin(reducers) {\n      var _this = this;\n\n      // use 'function' keyword to enable 'this'\n      return decorate(function () {\n        var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : empty;\n        var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        return Object.keys(reducers).reduce(function (accumulator, key) {\n          var previousState = getIn(accumulator, key);\n          var nextState = reducers[key](previousState, action, getIn(state, key));\n          return nextState === previousState ? accumulator : setIn(accumulator, key, nextState);\n        }, _this(state, action));\n      });\n    };\n\n    return target;\n  }\n\n  return decorate(byForm(reducer));\n};\n\nexport default createReducer;"]},"metadata":{},"sourceType":"module"}